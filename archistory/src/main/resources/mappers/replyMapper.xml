<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace = "org.kkamnyang.mapper.Replymapper">

<select id="list" resultType="replyVO">
select * from tbl_reply where boardNo = #{boardNo} order by replyNo desc
</select>

<insert id="create">
insert into tbl_reply(replyNo, boardNo, content, writer)
values(seq_reply.nextval, #{boardNo}, #{content}, #{writer})
</insert>

<update id="update">
update TBL_REPLY 
set content = #{content}, updatedate=sysdate 
where replyNo = #{replyNo}
</update>

<delete id="delete">
delete from tbl_reply where replyNo = #{replyNo}
</delete>

<select id="listPage" resultType="replyVO">
<![CDATA[
select * from (
select /*+INDEX_DESC(tbl_reply pk_reply)*/
rownum rn, replyNo, boardNo, content, writer, regdate, updatedate
from tbl_reply
where boardNo = #{boardNo}
and replyNo > 0
and rownum <= #{cri.page}*#{cri.perPageNum})
where rn > (#{cri.page}-1)*#{cri.perPageNum}
]]>
</select>

<select id="count" resultType="int">
select count(boardNo) from tbl_reply where boardNo=#{boradNo}
</select>

<select id="getBoardNo" resultType="int">
select boardNo from tbl_reply where replyNo = #{replyNo}
</select>

</mapper>